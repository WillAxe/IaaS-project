import{r as l,j as e,a as _}from"./index-X9nRkZfa.js";function I(){const s=localStorage.getItem("userId"),[u,j]=l.useState(null),[p,y]=l.useState(null),[o,h]=l.useState(()=>{const t=localStorage.getItem(`experiences_${s}`);return t?JSON.parse(t):[]}),[d,m]=l.useState(()=>{const t=localStorage.getItem(`educations_${s}`);return t?JSON.parse(t):[]}),[r,x]=l.useState({company:"",title:"",years:""}),[i,g]=l.useState({school:"",degree:"",years:""});l.useEffect(()=>{if(!s)return;(async()=>{try{const n=await(await fetch(`/jobmatch/user/${s}`)).json();if(n.user?.user_experience){const c=typeof n.user.user_experience=="string"?JSON.parse(n.user.user_experience):n.user.user_experience;h(c),localStorage.setItem(`experiences_${s}`,JSON.stringify(c))}if(n.user?.user_education){const c=typeof n.user.user_education=="string"?JSON.parse(n.user.user_education):n.user.user_education;m(c),localStorage.setItem(`educations_${s}`,JSON.stringify(c))}}catch(a){console.error("Fel vid hämtning av erfarenheter:",a)}})()},[s]),l.useEffect(()=>{s&&localStorage.setItem(`experiences_${s}`,JSON.stringify(o))},[o,s]);const f=t=>{x({...r,[t.target.name]:t.target.value})};l.useEffect(()=>{s&&localStorage.setItem(`educations_${s}`,JSON.stringify(d))},[d,s]);const N=t=>{g({...i,[t.target.name]:t.target.value})},b=async()=>{if(!r.company||!r.title||!r.years)return;let t;u!==null?(t=o.map((a,n)=>n===u?r:a),j(null)):t=[...o,r],h(t),x({company:"",title:"",years:""});try{await fetch(`http://localhost:3000/jobmatch/user/experience/${s}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_experience:t})})}catch(a){console.error("Kunde inte uppdatera erfarenheter i databasen:",a)}},E=async()=>{if(!i.school||!i.degree||!i.years)return;let t;p!==null?(t=d.map((a,n)=>n===p?i:a),y(null)):t=[...d,i],m(t),g({school:"",degree:"",years:""});try{await fetch(`http://localhost:3000/jobmatch/user/education/${s}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_education:t})})}catch(a){console.error("Kunde inte uppdatera utbildningar i databasen:",a)}},v=async t=>{const a=o.filter((n,c)=>c!==t);h(a),localStorage.setItem(`experiences_${s}`,JSON.stringify(a));try{await fetch(`http://localhost:3000/jobmatch/user/experience/${s}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_experience:a})})}catch(n){console.error("Kunde inte uppdatera erfarenheter i databasen:",n)}},S=async t=>{const a=d.filter((n,c)=>c!==t);m(a),localStorage.setItem(`educations_${s}`,JSON.stringify(a));try{await fetch(`http://localhost:3000/jobmatch/user/education/${s}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_education:a})})}catch(n){console.error("Kunde inte uppdatera utbildningar i databasen:",n)}};return e.jsxs("div",{className:"profile-container",children:[e.jsx("div",{children:e.jsx(_,{to:`/account-settings/${s}`,className:"manage-account-button",children:"Hantera konto"})}),e.jsx("h1",{className:"profile-title",children:"Min Profil"}),e.jsxs("div",{className:"form-card",children:[e.jsx("h2",{className:"form-title",children:"Lägg till Jobberfarenhet"}),e.jsxs("div",{className:"form-fields",children:[e.jsx("input",{name:"company",placeholder:"Företag",value:r.company,onChange:f,className:"input-field"}),e.jsx("input",{name:"title",placeholder:"Jobbtitel",value:r.title,onChange:f,className:"input-field"}),e.jsx("input",{name:"years",placeholder:"År (t.ex. 2020–2023)",value:r.years,onChange:f,className:"input-field"}),e.jsx("button",{onClick:b,className:"add-button",children:u!==null?"Uppdatera Erfarenhet":"Lägg till Erfarenhet"})]})]}),e.jsxs("div",{className:"experience-section",children:[e.jsx("h3",{className:"section-title",children:"Mina erfarenheter"}),e.jsx("div",{className:"experience-list",children:o.length===0?e.jsx("p",{className:"no-exp",children:"Inga erfarenheter tillagda ännu."}):o.map((t,a)=>e.jsxs("div",{className:"experience-card",children:[e.jsx("div",{className:"exp-company",children:t.company}),e.jsx("div",{className:"exp-title",children:t.title}),e.jsx("div",{className:"exp-years",children:t.years}),e.jsxs("div",{className:"button-row",children:[e.jsx("button",{onClick:()=>v(a),className:"delete-button",children:"Ta bort"}),e.jsx("button",{onClick:()=>{x(t),j(a)},className:"edit-button",children:"Redigera"})]})]},a))})]}),e.jsxs("div",{className:"form-card",children:[e.jsx("h2",{className:"form-title",children:"Lägg till Utbildning"}),e.jsxs("div",{className:"form-fields",children:[e.jsx("input",{name:"school",placeholder:"Skola / Universitet",value:i.school,onChange:N,className:"input-field"}),e.jsx("input",{name:"degree",placeholder:"Examen / Program",value:i.degree,onChange:N,className:"input-field"}),e.jsx("input",{name:"years",placeholder:"År (t.ex. 2018–2021)",value:i.years,onChange:N,className:"input-field"}),e.jsx("button",{onClick:E,className:"add-button",children:p!==null?"Uppdatera":"Lägg till Utbildning"})]})]}),e.jsxs("div",{className:"experience-section",children:[e.jsx("h3",{className:"section-title",children:"Mina utbildning"}),e.jsx("div",{className:"experience-list",children:d.length===0?e.jsx("p",{className:"no-exp",children:"Ingen utbildning tillagd ännu."}):d.map((t,a)=>e.jsxs("div",{className:"experience-card",children:[e.jsx("div",{className:"exp-company",children:t.school}),e.jsx("div",{className:"exp-title",children:t.degree}),e.jsx("div",{className:"exp-years",children:t.years}),e.jsxs("div",{className:"button-row",children:[e.jsx("button",{onClick:()=>S(a),className:"delete-button",children:"Ta bort"}),e.jsx("button",{onClick:()=>{g(t),y(a)},className:"edit-button",children:"Redigera"})]})]},a))})]})]})}export{I as default};
